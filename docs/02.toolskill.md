# PCAI 工具與技能指南 (Tools & Skills Guide)

本文件詳細說明 PCAI 專案中可用的 **工具 (Tools)** 與 **技能 (Skills)**，以及它們的使用時機與操作方式。

---

## 🛠️ 核心工具 (Core Tools)

核心工具是由 Go 語言原生實作的功能，提供系統操作、檔案管理、記憶存取等基礎能力。

### 1. 系統與排程管理

| 工具名稱 | 用途簡述 | 詳細說明與使用時機 |
| :--- | :--- | :--- |
| **manage_cron_job** | 管理定時任務 | **用途**: 設定或取消週期性的背景任務 (如每天早上讀信)。<br>**使用時機**: 當使用者要求「每天/每週自動做某事」時。<br>**參數**: `action` (add/remove), `cron_expression` (e.g. "0 8 * * *"), `task_type`。 |
| **list_tasks** | 列出任務狀態 | **用途**: 顯示目前執行中的背景任務與已註冊的排程工作。<br>**使用時機**: 當使用者詢問「你在做什麼？」、「有哪些排程？」或「任務進度如何？」時。 |
| **shell_exec** | 執行 Shell 指令 | **用途**: 在沙箱環境中執行系統指令 (ls, mkdir, git 等)。<br>**使用時機**: 需要執行簡單的系統操作、Git 操作或檔案管理時。<br>**注意**: 優先使用專用的 `fs_*` 工具，只有當沒有替代工具時才用此工具。 |
| **get_current_time** | 取得系統時間 | **用途**: 獲得當前精確時間。<br>**使用時機**: 當需要確認時間以設定排程或回答時間相關問題時。 |

### 2. 檔案系統操作 (File System)

| 工具名稱 | 用途簡述 | 詳細說明與使用時機 |
| :--- | :--- | :--- |
| **fs_list_dir** | 列出目錄內容 | **用途**: 查看資料夾下的檔案列表。<br>**使用時機**: 探索專案結構或確認檔案是否存在時。 |
| **fs_read_file** | 讀取檔案內容 | **用途**: 讀取文字檔案內容。會自動略過二進位檔。<br>**使用時機**: 需要分析程式碼、設定檔或文件時。 |
| **fs_write_file** | 寫入檔案 | **用途**: 建立或覆寫檔案內容。<br>**使用時機**: 產生新程式碼、設定檔或報告時。 |
| **fs_append_file** | 附加內容 | **用途**: 在檔案末尾新增內容。<br>**使用時機**: 寫入日誌 (Log) 或累積記錄時。 |
| **fs_mkdir** | 建立目錄 | **用途**: 建立新資料夾 (包含父目錄)。<br>**使用時機**: 初始化專案結構或整理檔案時。 |
| **fs_remove** | 刪除檔案/目錄 | **用途**: 刪除指定的檔案或目錄。<br>**使用時機**: 清理暫存檔或移除錯誤檔案時。 |

### 3. 記憶與知識庫 (Memory & Knowledge)

| 工具名稱 | 用途簡述 | 詳細說明與使用時機 |
| :--- | :--- | :--- |
| **memory_search** | 搜尋記憶 | **用途**: 檢索過去的對話、使用者偏好或專案知識。<br>**使用時機**: 當你不確定問題答案，或覺得以前曾經討論過時。 |
| **memory_save** | 儲存記憶 | **用途**: 將重要資訊永久保存。<br>**使用時機**: 當使用者要求「記住」某事，或提供了新的個人資訊、專案細節時。 |
| **memory_forget** | 遺忘記憶 | **用途**: 刪除特定的記憶內容。<br>**使用時機**: 當使用者要求「忘記」或「刪除」某項資訊時。 |
| **knowledge_search**| 搜尋長期知識 | **用途**: 專門搜尋 `knowledge.md` 中的結構化知識。<br>**使用時機**: 查詢已整理的長篇知識或文件。 |
| **knowledge_append**| 新增長期知識 | **用途**: 將事實歸檔到 `knowledge.md` 並自動分類。<br>**使用時機**: 記錄確定的事實、規則或筆記 (如「使用者喜歡 Python」)。 |

### 4. 外部資訊獲取 (Web & External)

| 工具名稱 | 用途簡述 | 詳細說明與使用時機 |
| :--- | :--- | :--- |
| **web_search** | 網路搜尋 | **用途**: 使用搜尋引擎 (Brave) 查詢即時資訊。<br>**使用時機**: 回答時事問題、查詢最新技術文件或解決方案時。 |
| **web_fetch** | 讀取網頁內容 | **用途**: 下載並解析特定 URL 的網頁內容 (支援 Firecrawl 與 Readability)。<br>**使用時機**: 當需要深入閱讀某個網頁連結的詳細內容時。 |
| **google_services** | Google 服務 | **用途**: 這是底層工具，通常透過 Skills (如 read_email) 間接使用。<br>**使用時機**: 直接操作 `gog` CLI 進行進階 Google 服務操作。 |
| **read_email** | 讀取 Gmail | **用途**: (工具版) 透過 `gog` CLI 搜尋與讀取 Gmail 郵件。<br>**使用時機**: 查詢信箱內容、尋找特定郵件。 |

### 5. 進階開發與分析 (Development & Analysis)

| 工具名稱 | 用途簡述 | 詳細說明與使用時機 |
| :--- | :--- | :--- |
| **run_python_code** | 執行 Python | **用途**: 在 Docker 沙箱中執行 Python 程式碼。<br>**使用時機**: 進行數據分析、繪圖、複雜計算或測試 Python 腳本時。 |
| **task_planner** | 任務規劃 | **用途**: 管理多步驟的複雜任務 (Create/Update/Get Plan)。<br>**使用時機**: 當任務無法一步完成，需要拆解成多個步驟逐步執行時 (如「分析整個專案並重構」)。 |
| **convert_videos** | 影片轉檔 | **用途**: 批次轉換影片格式 (使用 FFmpeg)。<br>**使用時機**: 當使用者需要轉換影片格式或壓縮影片時。 |
| **analyze_architecture** | 架構分析 | **用途**: 分析需求是適合做成 Skill 還是 Tool。<br>**使用時機**: 開發新功能前的評估階段。 |

### 6. 技能管理 (Skill Management)

| 工具名稱 | 用途簡述 | 詳細說明與使用時機 |
| :--- | :--- | :--- |
| **list_skills** | 列出所有技能 | **用途**: 顯示系統中所有已安裝的 Tool 和 Skill。<br>**使用時機**: 自我檢查或回答使用者關於功能的問題。 |
| **create_new_skill**| 建立新技能 | **用途**: 產生 Go 語言的 Skill 程式碼腳手架。<br>**使用時機**: 當需要開發新的擴充功能時。 |
| **install_github_skill** | 安裝技能 | **用途**: 從 GitHub 下載並安裝現成的 Skill。<br>**使用時機**: 引入社群或第三方的擴充功能時。 |

---

## 🧩 技能 (Skills)

技能是基於工具或特定邏輯封裝的高階能力，通常位於 `skills/` 目錄下。

### 1. Task Planning (任務規劃)
- **ID**: `task_planning`
- **描述**: 用於分析複雜任務並將其分解為可執行的步驟計畫。
- **使用時機**: 當使用者提出複雜請求 (如「重構整個模組」) 時，先使用此技能建立計畫，再逐步執行。

### 2. Calendar Reader (行事曆讀取)
- **ID**: `read_calendars`
- **描述**: 讀取與管理 Google Calendar 行程。
- **能力**:
    - 列出特定時間範圍的活動 (今天、本週)。
    - 支援自然語言時間解析 (轉為 `YYYY-MM-DD`)。
- **使用時機**: 當使用者詢問行程、會議或時間安排時。

### 3. Email Reader (郵件讀取)
- **ID**: `read_email`
- **描述**: 讀取與搜尋 Gmail 郵件。
- **能力**:
    - 列出最新郵件。
    - 搜尋特定關鍵字 (From, Subject)。
    - 讀取郵件內文並摘要。
- **使用時機**: 當使用者詢問新信件或查找特定通知時。

### 4. Taiwan Weather (台灣天氣)
- **ID**: `get_taiwan_weather`
- **描述**: 查詢台灣各縣市的天氣預報 (來源: Google Sheets 資料庫)。
- **能力**: 提供目前時段及未來的降雨機率與天氣描述。
- **使用時機**: 當使用者詢問台灣特定地區的天氣狀況時。

---

## 💡 使用原則 (General Principles)

1.  **優先使用專用工具**: 例如要讀檔時，請用 `fs_read_file` 而不是 `shell_exec("cat ...")`，因為專用工具通常有更好的錯誤處理與輸出格式。
2.  **善用任務規劃**: 對於超過 3 個步驟的任務，強烈建議使用 `task_planner` 來追蹤進度，避免迷失方向。
3.  **記憶管理**: 
    - 短期資訊 (如當下對話) 不需要特別存。
    - 長期資訊 (如使用者偏好、重要決策) 請主動使用 `memory_save` 或 `knowledge_append`。
4.  **安全第一**: `shell_exec` 與 `fs_*` 操作應僅限於工作目錄 (Sandbox) 內，避免修改系統關鍵檔案。
